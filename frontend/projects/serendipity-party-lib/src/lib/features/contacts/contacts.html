<command-bar>

  @if (isHandsetPortrait()) {

    <ng-container>

      <button matIconButton class="md-command-bar-button" (click)="onNew()" aria-label="New Contact button">
        <mat-icon class="material-icons">add</mat-icon>
      </button>

      <button matIconButton class="md-command-bar-button" [disabled]="true" aria-label="Run Report button">
        <mat-icon class="material-icons">description</mat-icon>
      </button>

    </ng-container>

  } @else {

    <ng-container>

      <button matButton="filled" class="md-command-bar-button" (click)="onNew()" aria-label="New Contact button">
        <mat-icon class="material-icons">add</mat-icon>
        NEW
      </button>

      <button matButton="filled" class="md-command-bar-button" aria-label="Run Report button">
        <mat-icon class="material-icons">description</mat-icon>
        RUN REPORT
      </button>

    </ng-container>

  }

</command-bar>

<activity-bar>

  <span class="md-font-headline-lg" aria-label="Activity Bar Title">
    Contacts
  </span>

</activity-bar>

<div class="md-content-container">

  <div class="md-table-container">

    <!--
    @if (isLoading) {
      <mat-spinner class="md-spinner"></mat-spinner>
    }
    -->

    <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">

      <!--
        The Angular Material Table does not support content projection (e.g., <ng-content>) if you
        dynamically create your columns ...

        See: https://stackoverflow.com/questions/53335929/content-projection-inside-angular-material-table
      -->

      @for (column of columnDefs; track $index) {

        <ng-container [matColumnDef]="column.name">

          <th mat-header-cell *matHeaderCellDef>
            {{column.displayName}}
          </th>

          <td mat-cell *matCellDef="let row">

            <!-- See: .scss for the mat-column styles -->

            @if (!column.routerLink) {

              <ng-container>
                {{ getProperty(row, column.name) }}
              </ng-container>

            } @else {

              @if (column.name === 'party.displayName') {
                <a [routerLink]="[getProperty(row, column.routerLink)]">
                  {{ getProperty(row, column.name) }}
                </a>
              }

              @if (column.name === 'organisation.displayName') {
                <a [routerLink]="['/customers/accounts', getProperty(row, column.routerLink)]">
                  {{ getProperty(row, column.name) }}
                </a>
              }

            }

          </td>

        </ng-container>

      }

      <!-- ID column (padding column RTL) -->

      <ng-container matColumnDef="id">

        <th mat-header-cell *matHeaderCellDef>
          <button matIconButton class="md-table-header-id-column" aria-label="Reload button">
            <mat-icon class="material-icons">autorenew</mat-icon>
          </button>
        </th>

        <td mat-cell *matCellDef="let element"> </td>
        <td mat-footer-cell *matFooterCellDef> </td>

      </ng-container>

      <!-- Footer -->

      <ng-container matColumnDef="footer">

        <td mat-footer-cell *matFooterCellDef [attr.colspan]="footerColSpan">
          <collection-footer [host]="this">
          </collection-footer>
        </td>

      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      <tr mat-footer-row *matFooterRowDef="['footer']; sticky: true"></tr>

    </table>

  </div>

</div>

